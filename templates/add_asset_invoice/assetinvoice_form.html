{% extends "base.html" %}
{% load static %}

{% block title %}{% endblock %}
{% block content %}
<div style="direction: rtl;" class="main container">
    <div class="col-md-12 content-wrapper first_container">
        <div class="second_container">
            <div class="adress_name">
                <h2>فاتورة </h2>
            
            </div>
            <form  action="" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <details open=""><summary class="adress_containt">بيانات اخري</summary>
                    <div class="details">
                    <details><summary class="adress_header">بيانات المرفقات</summary>
                        <div style=" display: inline">
                                {{ form.invoice_image }}
                        </div>
                
                            {% if object.invoice_image %}
                        <div style=" display: inline;margin-right:200px"><img style="height: 50px; width: 50px;" src="{{ object.invoice_image.url }}"
                            alt="Invoice Image" class="img-circle img-fluid">
                        </div>
                            {% else %}
                        <div style=" display: inline"><img style="height: 50px; width: 50px;" src=""
                            alt="Invoice Image" class="img-circle img-fluid">
                        </div>
                            {% endif %}
                            <hr>
                        <div style=" display: inline">
                            {{ form.invoice_pdf }}
                        </div>
                        <div style=" display: inline">
                            file.pdf
                        </div>
                            <hr>

                    </details>
                    <details><summary class="adress_header">بيانات المورد</summary>
                        <div class="invoice_feild table-container">
                    
                            <!--{{ form.as_p }}-->
                            <table class="table_invoice">
                                <thead class="table_header">
                                    <tr>
                                        <th>رقم الفاتورة</th>
                                        <th>تاريخ الفاتورة</th>
                                        <th>اسم المورد</th>
                                        <th>تليفون المورد</th>
                                        <th>عنوان المورد</th>
                                    </tr>
                                </thead>
                                <tbody class="table_body">
                                    <tr >
                                        <td>{{ form.invoice_number }}</td>
                                        <td>{{ form.invoice_date }}</td>
                                        <td>{{ form.company_name }}</td>
                                        <td>{{form.supplier_phone}}</td>
                                        <td>{{form.supplier_address}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <br>
                            <table class="table_invoice">
                                <thead class="table_header">
                                    <tr>
                                        <th>اسم المحول الية</th>
                                        <th>رقم البطاقة</th>
                                        <th>سجل تجاري</th>
                                        <th>بطاقة ضريبية</th>
                                    
                                    </tr>
                                </thead>
                                <tbody class="table_body">
                                    <tr >
                                        <td>{{ form.supplier_name }}</td>
                                        <td>{{ form.id_card_number }}</td>
                                        <td>{{ form.commercial_record }}</td>
                                        <td>{{ form.tax_card }}</td>
                                        
                                    </tr>
                                </tbody>
                            </table>
                            <br>
                            <table class="table_invoice">
                                <thead class="table_header">
                                    <tr>
                                        
                                        <th>رقم الحساب</th>
                                        <th>اسم البنك</th>
                                    </tr>
                                </thead>
                                <tbody class="table_body">
                                    <tr >
                                        
                                        <td>{{form.bank_account_number_to}}</td>
                                        <td>{{form.bank_name_to}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </details>
                    <details><summary class="adress_header">بيانات انظمة ضريبة الاضافة</summary>
                        <div class="table_feild table-container">
                        <table class="table_items">
                            {{ addition_tax.management_form }}
                            {% for form in addition_tax.forms %}
                            {% if forloop.first %}
                            <thead>
                                <tr class='invoice_field table_header'>
                                    {% for field in form.visible_fields %}
                                    <th>{{ field.label|capfirst }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            {% endif %}

                            
                            <tr class="{% cycle row1 row2 %} formset_row_additiontax invoice_field sticky-row table_body_additiontax">
                            
                                    {% for field_addition in form.visible_fields %}
                                <td>
                                    {# Include the hidden fields in the form #}
                                    {% if forloop.first %}
                                    {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                    {% endfor %}
                                    {% endif %}
                                    {{ field_addition.errors.as_ul }}
                                    {{ field_addition }}
                                </td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </table>
                        </div>
                    </details>
                    <details><summary class="adress_header">بيانات انظمة ضريبة الخصم</summary>
                        <div class="table_feild table-container">
                        <table class="table_items">
                            {{ minus_tax.management_form }}
                            {% for form in minus_tax.forms %}
                            {% if forloop.first %}
                            <thead>
                                <tr class='invoice_field table_header'>
                                    {% for field in form.visible_fields %}
                                    <th>{{ field.label|capfirst }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            {% endif %}
                            <tr class="{% cycle row1 row2 %} formset_row_minustax invoice_field sticky-row table_body_additiontax">
                                    {% for field_minus in form.visible_fields %}
                                <td>
                                    {# Include the hidden fields in the form #}
                                    {% if forloop.first %}
                                    {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                    {% endfor %}
                                    {% endif %}
                                    {{ field_minus.errors.as_ul }}
                                    {{ field_minus }}
                                </td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </table>
                        </div>
                    </details>
                    <details><summary class="adress_header">بيانات المصروفات</summary>
                        <div class="table_feild table-container">
                        <table class="table_items">
                            {{ expenses_cost.management_form }}
                            {% for form in expenses_cost.forms %}
                            {% if forloop.first %}
                            <thead>
                                <tr class='invoice_field table_header'>
                                    {% for field in form.visible_fields %}
                                    <th>{{ field.label|capfirst }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            {% endif %}
                            <tr class="{% cycle row1 row2 %} formset_row_expensescost invoice_field sticky-row table_body_additiontax">
                                    {% for field_expensescost in form.visible_fields %}
                                <td>
                                    {# Include the hidden fields in the form #}
                                    {% if forloop.first %}
                                    {% for hidden in form.hidden_fields %}
                                    {{ hidden }}
                                    {% endfor %}
                                    {% endif %}
                                    {{ field_expensescost.errors.as_ul }}
                                    {{ field_expensescost }}
                                </td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </table>
                    </details>
                        
                </details>
                
                <div class="details_invoice">
                    <h4 class="adress_name defrent">ملخص الفاتورة</h4>
                    <table class="table_invoice table_items uii my-custom-table">
                        <thead>
                            <tr class="table_header">
                                <th>اجمالي السعر</th>
                                <th>اجمالي ضريبة الاضافة</th>
                                <th>اجمالي ضريبة الخصم</th>
                                <th>اجمالي المصروفات</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table_body">
                                <td class="disabled">{{form.total_price}}</td>
                                <td class="disabled">{{form.total_addition_tax}}</td>
                                <td class="disabled">{{form.total_minus_tax}}</td>
                                <td class="disabled">{{form.total_expences_cost}}</td>
                                
                            </tr>
                        </tbody>
                    </table>
                   <hr>
                   
                    <table class="table_invoice table_items uii my-custom-table">
                        <thead>
                            <tr class="table_header">
                                <th>صافي الفاتورة</th>
                                <th>المدفوع</th>
                                <th>المتبقي</th>
                                <th>الفرع</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table_body">
                                <td class="disabled">{{ form.total_invoice_cost }}</td>
                                <td>{{ form.amount_paid }}</td>
                                <td class="disabled">{{ form.remaining_balance }}</td>
                                <td>{{ form.branch_name }}</td>
                            </tr>
                        </tbody>
                    </table>
                
                </div>
                
                <div class="table_feild table-container">
                    <h4 class="adress_name defrent">جدول الاصناف<h4>
                    <table class="table-items invoice_items">
                        {{ asset_items.management_form }}
                        <tr class='invoice_field table_header'>
                            <th>رقم الاصل</th>
                            <th>اسم الاصل</th>
                            <th>التصنيف</th>
                            <th>البيان</th>
                            <th>عدد</th>
                            <th>سعر الوحدة</th>
                            <th>السعر الاجمالي</th>
                            <th>الفرع</th>
                            <th>حذف</th>
                        </tr>
                           
                            {% for form in asset_items.forms %}
                        <tr class="{% cycle row1 row2 %} formset_additems invoice_field sticky-row table_body">
                            {% for field in form.visible_fields %}
                                <td>
                                    {# Include the hidden fields in the form #}
                                    {% if forloop.first %}
                                        {% for hidden in form.hidden_fields %}
                                            {{ hidden }}
                                        {% endfor %}
                                    {% endif %}
                                    {{ field.errors.as_ul }}
                                    {{ field }}
                                    
                                </td>
                            
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </table>
                </div>
                
                 
                <!-- url 'invoice-update' invoice.pk -->
                <!--"{% url 'invoice-list' %}"-->
                <input class="add-row button" type="submit" value="حفظ"/>
               
               
              <!-- قم بتعديل اللينك ليناسب هيكل مشروعك -->
                {% if object %}
                <a class="add-row button" href="{% url 'generate_assets_report' invoice_number_id=object.pk %}" target="_blank"> طباعة </a>
                {% else %}
    
                {% endif %}
                <a href="{% url 'invoice-list' %}">الانتقال الي القائمة</a>
           

            </form>
        </div>
    </div>
</div>
   
{% endblock %}
